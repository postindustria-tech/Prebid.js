<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>
    <script async src="../../build/dev/prebid.js"></script>
    <meta charset="utf-8">
    <style>
        body {
            color: #555;
            font-family: sans-serif;
        }
    </style>
    <script>
        var PREBID_TIMEOUT = 1000;
        var FAILSAFE_TIMEOUT = 3000;

        var googletag = googletag || {};
        googletag.cmd = googletag.cmd || [];

        var pbjs = pbjs || {};
        pbjs.que = pbjs.que || [];

        function initAdserver() {
            if (pbjs.initAdserverSet) return;

            googletag.cmd.push(function () {
                pbjs.que.push(function () {
                    pbjs.setTargetingForGPTAsync();
                    googletag.pubads().refresh();
                });
            });

            pbjs.initAdserverSet = true;
        }

        pbjs.que.push(function () {
            var adUnits = [{
                code: 'div-banner-native-1',
                mediaTypes: {
                    banner: {
                        sizes: [
                            [300, 250]
                        ]
                    },
                    native: {
                        type: 'image'
                    },
                },
                bids: [
                    {
                        bidder: 'appnexus',
                        params: {
                            placementId: 13232392,
                        },
                    },
                ],
            },
                {
                    code: 'div-banner-native-2',
                    mediaTypes: {
                        // banner: {
                        //     sizes: [
                        //         [300, 250]
                        //     ]
                        // },
                        // native: {
                        //     title: {
                        //         required: true
                        //     },
                        //     image: {
                        //         required: true
                        //     },
                        //     sponsoredBy: {
                        //         required: true
                        //     }
                        // }
                        video: {
                            context: 'instream',
                            playerSize: [640, 480],
                            mimes: ['video/mp4', 'video/x-flv'],
                            protocols: [1, 2, 3, 4, 5, 6],
                            playbackmethod: [1],
                            skip: 1,
                            minduration: 5,
                            maxduration: 30,
                            startdelay: 0,
                            linearity: 1,
                            api: [1, 2],
                            ext: {
                                reward: {
                                    currency: 'USD',
                                    amount: 0.01
                                }
                            }
                        }
                    },
                    bids: [
                        {
                            bidder: 'appnexus',
                            params: {
                                placementId: 13232392,
                            }
                        },
                        {
                            bidder: 'brid',
                            params: {
                                placementId: 13232392,
                            }
                        }
                    ]
                }
            ];

            pbjs.setConfig({debug: true});

            pbjs.addAdUnits(adUnits);

            pbjs.requestBids({
                timeout: PREBID_TIMEOUT,
                bidsBackHandler: function (bidResponses) {
                    initAdserver();
                }
            });
        });
        setTimeout(initAdserver, FAILSAFE_TIMEOUT);
    </script>

    <script>
        googletag.cmd.push(function () {
            googletag
                .defineSlot(
                    '/19968336/prebid_multiformat_test', [
                        [300, 250],
                        [360, 360]
                    ],
                    'div-banner-native-1'
                )
                .addService(googletag.pubads());

            googletag
                .defineSlot(
                    '/19968336/prebid_multiformat_test', [
                        [300, 250],
                        [360, 360]
                    ],
                    'div-banner-native-2'
                )
                .addService(googletag.pubads());

            googletag.pubads().disableInitialLoad();
            googletag.pubads().enableSingleRequest();
            googletag.enableServices();
        });
    </script>
    <title>Brid Bid Adapter - example of usage - Prebid.js</title>
</head>
<body>
<h2>Brid Bid Adapter - example of usage</h2>

<h3>div-banner-native-1</h3>
<div id='div-banner-native-1'>
    <p>No response</p>
    <script type='text/javascript'>
        googletag.cmd.push(function () {
            googletag.display('div-banner-native-1');
        });
    </script>
</div>

<h3>div-banner-native-2</h3>
<div id='div-banner-native-2'>
    <p>No response</p>
    <script type='text/javascript'>
        googletag.cmd.push(function () {
            googletag.display('div-banner-native-2');
        });
    </script>
</div>
</body>
</html>
